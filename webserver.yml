---
  - hosts: control
    become: true
#this is for webservers
    tasks:
     - name: install apache2
       apt: name={{item}} state=present update_cache=yes
       with_items:
           - apache2
           - libapache2-mod-wsgi
           - python-pip
           - python-virtualenv
           - pyrhon-mysqldb 
# we need mod_wsgi for python applications 
     - name: ensure apache2 starte
       service: name=apache2 state=started enabled=yes

     - name: ensure mod_wsgi enabled
       apache2_module: state=present name=wsgi
# after we enabled apache using apache2_module apache need to be restarted for that we are using 
# service handlers as service module canot do that as Ansible follows idempotation due to thtat service block will get skip if apache is already running
# but to trigger service handlers we are using NOTIFY module as service handlers do not get triggered by themselves. 
       notify: restart apache2

     - name: copy from demo app
       copy: src=/root/ansible/ansible_learn/app dest=/var/www/demo mode=0755

     - name: copy apache virtual host config
       copy: src=
 
  handlers: 
     - name: restart apache2
       service: name=apache2 state=restarted
